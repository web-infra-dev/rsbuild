# Wasm

O Rsbuild oferece suporte nativo para módulos WebAssembly (WASM), permitindo que você importe e use arquivos `.wasm` diretamente em seu projeto.

:::tip O que é WebAssembly
WebAssembly (Wasm) é um formato binário portátil e de alta performance projetado para executar tarefas de computação intensivas em CPU em navegadores web modernos, trazendo desempenho e confiabilidade semelhantes ao código compilado nativo para a plataforma web.
:::

## Importar

Você pode referenciar um módulo WebAssembly em um arquivo JavaScript usando importações nomeadas:

```js title="index.js"
import { add } from './add.wasm';

console.log(add); // [native code]
console.log(add(1, 2)); // 3
```

Módulos WebAssembly também podem ser importados via importação dinâmica:

```js title="index.js"
import('./add.wasm').then(({ add }) => {
  console.log('---- Módulo Wasm Assíncrono');
  console.log(add); // [native code]
  console.log(add(1, 2)); // 3
});
```

Você também pode obter o caminho de um módulo WebAssembly usando a sintaxe `new URL`:

```js title="index.js"
const wasmURL = new URL('./add.wasm', import.meta.url);

console.log(wasmURL).pathname; // "/static/wasm/[hash].module.wasm"
```

## Diretório de saída

Quando um ativo `.wasm` é importado, ele será gerado pelo Rsbuild para o diretório `dist/static/wasm` por padrão.

Você pode alterar o diretório de saída de arquivos `.wasm` através da configuração [output.distPath](/config/output/dist-path).

```ts
export default {
  output: {
    distPath: {
      wasm: 'resource/wasm',
    },
  },
};
```

## Declaração de tipo

Quando você importa um arquivo Wasm em código TypeScript, você geralmente precisa adicionar a declaração de tipo correspondente.

Por exemplo, o arquivo `add.wasm` exporta um método `add()`, então você pode criar um arquivo `add.wasm.d.ts` no mesmo diretório e adicionar a declaração de tipo correspondente:

```ts title="add.wasm.d.ts"
export const add = (num1: number, num2: number) => number;
```
