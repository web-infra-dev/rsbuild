# Webpack

Esta seÃ§Ã£o apresenta como migrar um projeto que usa webpack para o Rsbuild.

## Instalando dependÃªncias

Primeiro, vocÃª precisa substituir as dependÃªncias npm do webpack pelas dependÃªncias do Rsbuild.

import { PackageManagerTabs } from '@theme';

- Remover dependÃªncias do webpack:

<PackageManagerTabs command="remove webpack webpack-cli webpack-dev-server" />

- Instalar dependÃªncias do Rsbuild:

<PackageManagerTabs command="add @rsbuild/core -D" />

## Atualizando scripts npm

Em seguida, vocÃª precisa atualizar os scripts npm em seu package.json para usar os comandos CLI do Rsbuild.

```json title="package.json"
{
  "scripts": {
    "serve": "webpack serve -c webpack.config.js", // [!code --]
    "build": "webpack build -c webpack.config.js", // [!code --]
    "dev": "rsbuild dev", // [!code ++]
    "build": "rsbuild build" // [!code ++]
  }
}
```

## Criar arquivo de configuraÃ§Ã£o

Crie um arquivo de configuraÃ§Ã£o do Rsbuild `rsbuild.config.ts` no mesmo diretÃ³rio do package.json, e adicione o seguinte conteÃºdo:

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';

export default defineConfig({
  plugins: [],
});
```

> Consulte [Configurar Rsbuild](/guide/configuration/rsbuild) para mais informaÃ§Ãµes.

## MigraÃ§Ã£o de configuraÃ§Ã£o

Em um projeto webpack, pode haver alguns arquivos de configuraÃ§Ã£o `webpack.config.js` complexos.

ApÃ³s migrar para o Rsbuild, a maioria das configuraÃ§Ãµes do webpack sÃ£o embutidas e nÃ£o exigem configuraÃ§Ã£o manual, como output, resolve, module.rules, etc.

Para as poucas configuraÃ§Ãµes do webpack que precisam ser migradas, vocÃª pode escolher as seguintes opÃ§Ãµes:

- Use a opÃ§Ã£o [tools.rspack](/config/tools/rspack) (as configuraÃ§Ãµes do Rspack e do webpack sÃ£o basicamente equivalentes).

```ts title="rsbuild.config.ts"
export default {
  tools: {
    rspack: {
      plugins: [new SomeWebpackPlugin()],
    },
  },
};
```

- Use configuraÃ§Ãµes encapsuladas no Rsbuild, por exemplo, as opÃ§Ãµes para css-loader podem ser definidas atravÃ©s de [tools.cssLoader](/config/tools/css-loader).

> Consulte [Configurar Rspack](/guide/configuration/rspack) para mais informaÃ§Ãµes.

### Entrada da build

O webpack usa o campo `entry` para definir a entrada da build. No Rsbuild, vocÃª pode usar [source.entry](/config/source/entry) para defini-la.

```ts title="rsbuild.config.ts"
export default {
  source: {
    entry: {
      foo: './src/pages/foo/index.ts',
      bar: './src/pages/bar/index.ts',
    },
  },
};
```

### Limpando a configuraÃ§Ã£o

Como o Rsbuild tem alguns loaders e plugins comuns embutidos, vocÃª pode remover as seguintes dependÃªncias, o que melhorarÃ¡ significativamente a velocidade de instalaÃ§Ã£o das dependÃªncias do projeto:

- css-loader
- babel-loader
- style-loader
- postcss-loader
- html-webpack-plugin
- mini-css-extract-plugin
- autoprefixer
- @babel/core
- @babel/preset-env
- @babel/preset-typescript
- @babel/runtime
- ...

:::tip
O acima lista apenas algumas das dependÃªncias comuns que podem ser removidas. Em projetos webpack reais, pode haver muitas outras dependÃªncias, por favor, lide com elas de forma apropriada.
:::

### Usando plugins

O Rsbuild oferece um rico conjunto de plugins que fornecem suporte pronto para uso para cenÃ¡rios comuns. VocÃª pode consultar a documentaÃ§Ã£o [Lista de Plugins](/plugins/list/index) para aprender sobre esses plugins.

Tomando um projeto React como exemplo, let's see how to integrate Rsbuild plugins. First, you can remove some React-related build dependencies that are already built into the Rsbuild React plugin, such as:

- `react-refresh`
- `@babel/preset-react`
- `@pmmmwh/react-refresh-webpack-plugin`

Then see the [React Plugin](/plugins/list/plugin-react) documentation, register it and use it as follows:

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';
import { pluginReact } from '@rsbuild/plugin-react'; // [!code highlight]

export default defineConfig({
  plugins: [pluginReact()], // [!code highlight]
});
```

A maioria dos loaders e plugins comuns do webpack ainda podem ser usados no Rsbuild, mas recomendamos priorizar os plugins fornecidos pelo Rsbuild. Isso pode simplificar ainda mais sua configuraÃ§Ã£o. Abaixo estÃ¡ a relaÃ§Ã£o de mapeamento:

| webpack                                                                                    | Rsbuild                                                                                                         |
| :----------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------- |
| [@babel/preset-react](https://npmjs.com/package/@babel/preset-react)                       | [Plugin React](/plugins/list/plugin-react)                                                                      |
| [vue-loader](https://npmjs.com/package/vue-loader)                                         | [Plugin Vue](/plugins/list/plugin-vue) ou [Plugin Vue 2](https://github.com/rspack-contrib/rsbuild-plugin-vue2) |
| [svelte-loader](https://npmjs.com/package/svelte-loader)                                   | [Plugin Svelte](/plugins/list/plugin-svelte)                                                                    |
| [babel-preset-solid](https://npmjs.com/package/babel-preset-solid)                         | [Plugin Solid](/plugins/list/plugin-solid)                                                                      |
| [babel-loader](https://npmjs.com/package/babel-loader)                                     | [Plugin Babel](/plugins/list/plugin-babel)                                                                      |
| [sass-loader](https://npmjs.com/package/sass-loader)                                       | [Plugin Sass](/plugins/list/plugin-sass)                                                                        |
| [less-loader](https://npmjs.com/package/less-loader)                                       | [Plugin Less](/plugins/list/plugin-less)                                                                        |
| [stylus-loader](https://npmjs.com/package/stylus-loader)                                   | [Plugin Stylus](/plugins/list/plugin-stylus)                                                                    |
| [mdx-loader](https://npmjs.com/package/mdx-loader)                                         | [Plugin MDX](https://github.com/rspack-contrib/rsbuild-plugin-mdx)                                              |
| [pug-loader](https://npmjs.com/package/pug-loader)                                         | [Plugin Pug](https://github.com/rspack-contrib/rsbuild-plugin-pug)                                              |
| [yaml-loader](https://npmjs.com/package/yaml-loader)                                       | [Plugin Yaml](https://github.com/rspack-contrib/rsbuild-plugin-yaml)                                            |
| [toml-loader](https://npmjs.com/package/toml-loader)                                       | [Plugin Toml](https://github.com/rspack-contrib/rsbuild-plugin-toml)                                            |
| [@svgr/webpack](https://npmjs.com/package/@svgr/webpack)                                   | [Plugin SVGR](/plugins/list/plugin-svgr)                                                                        |
| [fork-ts-checker-webpack-plugin](https://npmjs.com/package/fork-ts-checker-webpack-plugin) | [@rsbuild/plugin-type-check](https://github.com/rspack-contrib/rsbuild-plugin-type-check)                       |
| [node-polyfill-webpack-plugin](https://npmjs.com/package/node-polyfill-webpack-plugin)     | [Plugin Node Polyfill](https://github.com/rspack-contrib/rsbuild-plugin-node-polyfill)                          |
| [@vue/babel-plugin-jsx](https://npmjs.com/package/@vue/babel-plugin-jsx)                   | [Plugin Vue JSX](https://github.com/rspack-contrib/rsbuild-plugin-vue-jsx)                                      |
| [@vue/babel-preset-jsx](https://npmjs.com/package/@vue/babel-preset-jsx)                   | [Plugin Vue 2 JSX](https://github.com/rspack-contrib/rsbuild-plugin-vue2-jsx)                                   |
| [eslint-webpack-plugin](https://npmjs.com/package/eslint-webpack-plugin)                   | [Plugin ESLint](https://github.com/rspack-contrib/rsbuild-plugin-eslint)                                        |
| [babel-plugin-styled-components](https://npmjs.com/package/babel-plugin-styled-components) | [Plugin Styled Components](https://github.com/rsbuild-contrib/rsbuild-plugin-styled-components)                 |

### Configurar servidor de desenvolvimento

O Rsbuild nÃ£o suporta o uso da configuraÃ§Ã£o [devServer](https://rspack.rs/config/dev-server) do Rspack. Consulte [Servidor de Desenvolvimento Rspack](/guide/basic/server#rspack-dev-server) para substituiÃ§Ã£o.

## MigraÃ§Ã£o do Babel

O Rsbuild usa SWC por padrÃ£o, entÃ£o a maioria dos plugins Babel comumente usados nÃ£o sÃ£o mais necessÃ¡rios. Aqui estÃ£o alguns exemplos de migraÃ§Ã£o de plugins Babel comuns.

### @babel/preset-env

`@babel/preset-env` nÃ£o Ã© mais necessÃ¡rio, o Rsbuild farÃ¡ o downgrade automÃ¡tico do cÃ³digo com base na configuraÃ§Ã£o [browserslist](/guide/advanced/browserslist).

Observe que o Rsbuild nÃ£o injeta polyfill por padrÃ£o. VocÃª pode consultar [Modo Polyfill](/guide/advanced/browser-compatibility#polyfill-mode) para saber como injetar.

### @babel/preset-typescript

`@babel/preset-typescript` nÃ£o Ã© mais necessÃ¡rio, as Rsbuild enables SWC's TypeScript transformation by default.

### @babel/preset-react

`@babel/preset-react` nÃ£o Ã© mais necessÃ¡rio, substitua-o por [@rsbuild/plugin-react](/plugins/list/plugin-react).

### @babel/plugin-transform-runtime

`@babel/plugin-transform-runtime` nÃ£o Ã© mais necessÃ¡rio, o Rsbuild tem o equivalente embutido `@swc/helpers` como helpers de runtime.

### babel-plugin-import

`babel-plugin-import` pode ser substituÃ­do pela configuraÃ§Ã£o [source.transformImport](/config/source/transform-import) no Rsbuild.

- ConfiguraÃ§Ã£o Babel:

```js title="babel.config.js"
module.exports = {
  plugins: [
    [
      'import',
      { libraryName: 'some-library', libraryDirectory: 'es', style: true },
    ],
  ],
};
```

- ConfiguraÃ§Ã£o Rsbuild:

```ts title="rsbuild.config.ts"
export default {
  source: {
    transformImport: [
      { libraryName: 'some-library', libraryDirectory: 'es', style: true },
    ],
  },
};
```

## Validando resultados

ApÃ³s concluir as etapas acima, vocÃª concluiu a migraÃ§Ã£o bÃ¡sica do webpack para o Rsbuild. Agora vocÃª pode executar o comando `npm run dev` para tentar iniciar o servidor de desenvolvimento.

Se vocÃª encontrar algum problema durante o processo de build, depure de acordo com o log de erro, ou verifique a configuraÃ§Ã£o do webpack para ver se hÃ¡ alguma configuraÃ§Ã£o necessÃ¡ria que nÃ£o foi migrada para o Rsbuild.

## Suplemento de conteÃºdo

O documento atual cobre apenas parte do processo de migraÃ§Ã£o. Se vocÃª encontrar conteÃºdo adequado para adicionar, sinta-se Ã  vontade para contribuir com a documentaÃ§Ã£o via pull request ğŸ¤.

> A documentaÃ§Ã£o para rsbuild can be found in the [rsbuild/website](https://github.com/web-infra-dev/rsbuild/tree/main/website) directory.
