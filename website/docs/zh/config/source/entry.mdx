# source.entry

- **类型：**

```ts
type Entry = Record<string, string | string[] | EntryDescription>;
```

- **默认值：**

```ts
const defaultEntry = {
  // 默认支持其他后缀，如 ts、tsx、jsx、mjs、cjs
  index: 'src/index.js',
};
```

用于设置构建的入口模块。

`source.entry` 的用法与 Rspack 的 [entry](https://rspack.dev/config/entry) 选项类似，它们的主要区别在于，Rsbuild 会为 `source.entry` 中的每一个入口注册 [html-webpack-plugin](https://github.com/jantimon/html-webpack-plugin)，从而生成对应的 HTML 文件。

- **示例：**

```ts title="rsbuild.config.ts"
export default {
  source: {
    entry: {
      foo: './src/pages/foo/index.ts',
      bar: './src/pages/bar/index.ts',
    },
  },
};
```

生成的目录结构如下：

```text
.
├── foo.html
├── bar.html
└── static
    ├── css
    │   ├── foo.css
    │   └── bar.css
    └── js
        ├── foo.js
        └── bar.js
```

如果你不需要生成 HTML 文件，可以将 [tools.htmlPlugin](/config/tools/html-plugin) 设置为 `false` 来禁用这一行为。

## 描述对象

`source.entry` 同样支持 Rspack 的 entry 描述对象写法，比如：

```ts title="rsbuild.config.ts"
export default {
  source: {
    entry: {
      foo: {
        import: './src/foo.js',
        runtime: 'foo',
      },
      bar: {
        import: './src/bar.js',
        runtime: 'bar',
      },
    },
  },
};
```

关于描述对象的完整用法，请参考 [Rspack - 入口描述对象](https://rspack.dev/config/entry#%E5%85%A5%E5%8F%A3%E6%8F%8F%E8%BF%B0%E5%AF%B9%E8%B1%A1)。

## 函数用法

`source.entry` 支持设置为一个函数，这通常用于为不同的构建产物类型设置不同的 entry 对象。

比如分别为 web 产物和 node 产物设置 entry：

```ts title="rsbuild.config.ts"
export default {
  source: {
    entry({ target }) {
      if (target === 'web') {
        return {
          index: './src/index.client.js',
        };
      }
      if (target === 'node') {
        return {
          index: './src/index.server.js',
        };
      }
    },
  },
  output: {
    targets: ['web', 'node'],
  },
};
```

## 基于 environment 设置

当你面向多个 [environments](/config/environments) 构建时，可以为每个 environment 设置不同的 entry：

比如为 `web` 和 `node` 环境设置不同的 entry：

```js
export default {
  environments: {
    web: {
      source: {
        entry: {
          index: './src/index.client.js',
        },
      },
      output: {
        target: 'web',
      },
    },
    node: {
      source: {
        entry: {
          index: './src/index.server.js',
        },
      },
      output: {
        target: 'node',
      },
    },
  },
};
```
