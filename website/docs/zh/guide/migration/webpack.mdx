# Webpack

æœ¬ç« èŠ‚ä»‹ç»å¦‚ä½•å°†ä½¿ç”¨ webpack çš„é¡¹ç›®è¿ç§»åˆ° Rsbuildã€‚

## å®‰è£…ä¾èµ–

é¦–å…ˆä½ éœ€è¦æŠŠ webpack ç›¸å…³çš„ npm ä¾èµ–æ›¿æ¢ä¸º Rsbuild çš„ä¾èµ–ã€‚

import { PackageManagerTabs } from '@theme';

- ç§»é™¤ webpack çš„ä¾èµ–ï¼š

<PackageManagerTabs command="remove webpack webpack-cli webpack-dev-server" />

- å®‰è£… Rsbuild çš„ä¾èµ–ï¼š

<PackageManagerTabs command="add @rsbuild/core -D" />

## æ›´æ–° npm scripts

ä¸‹ä¸€æ­¥ï¼Œä½ éœ€è¦æŠŠ package.json ä¸­çš„ npm scripts æ›´æ–°ä¸º Rsbuild çš„ CLI å‘½ä»¤ã€‚

```json title="package.json"
{
  "scripts": {
    "serve": "webpack serve -c webpack.config.js", // [!code --]
    "build": "webpack build -c webpack.config.js", // [!code --]
    "dev": "rsbuild dev", // [!code ++]
    "build": "rsbuild build" // [!code ++]
  }
}
```

## åˆ›å»ºé…ç½®æ–‡ä»¶

åœ¨ package.json çš„åŒçº§ç›®å½•ä¸‹åˆ›å»º Rsbuild çš„é…ç½®æ–‡ä»¶ `rsbuild.config.ts`ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';

export default defineConfig({
  plugins: [],
});
```

> æŸ¥çœ‹ [é…ç½® Rsbuild](/guide/configuration/rsbuild) äº†è§£æ›´å¤šã€‚

## é…ç½®è¿ç§»

åœ¨ä¸€ä¸ª webpack é¡¹ç›®ä¸­ï¼Œå¯èƒ½å·²ç»åŒ…å«äº†ä¸€äº›å¤æ‚çš„ `webpack.config.js` é…ç½®æ–‡ä»¶ã€‚

è€Œè¿ç§»åˆ° Rsbuild åï¼Œå¤§éƒ¨åˆ† webpack é…ç½®å·²ç»è¢« Rsbuild å†…ç½®ï¼Œä¸å†éœ€è¦æ‰‹åŠ¨é…ç½®ï¼Œæ¯”å¦‚ outputã€resolveã€module.rules ç­‰ã€‚

å¯¹äºå°‘éƒ¨åˆ†éœ€è¦è¿ç§»çš„ webpack é…ç½®ï¼Œä½ å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ–¹æ¡ˆï¼š

- ä½¿ç”¨ [tools.rspack](/config/tools/rspack) é€‰é¡¹ï¼ˆRspack å’Œ webpack çš„é…ç½®åŸºæœ¬ä¸Šç­‰ä»·ï¼‰ã€‚

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';

export default defineConfig({
  tools: {
    rspack: {
      plugins: [new SomeWebpackPlugin()],
    },
  },
});
```

- ä½¿ç”¨ Rsbuild å°è£…çš„é…ç½®é¡¹ï¼Œæ¯”å¦‚ css-loader çš„é€‰é¡¹å¯ä»¥é€šè¿‡ [tools.cssLoader](/config/tools/css-loader) è®¾ç½®ã€‚

> å‚è€ƒ [é…ç½® Rspack](/guide/configuration/rspack) äº†è§£æ›´å¤šã€‚

### æ„å»ºå…¥å£

webpack ä½¿ç”¨ `entry` å­—æ®µæ¥è®¾ç½®æ„å»ºå…¥å£ï¼Œåœ¨ Rsbuild ä¸­ä½ å¯ä»¥ä½¿ç”¨ [source.entry](/config/source/entry) æ¥è®¾ç½®ã€‚

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';

export default defineConfig({
  source: {
    entry: {
      foo: './src/pages/foo/index.ts',
      bar: './src/pages/bar/index.ts',
    },
  },
});
```

### æ¸…ç†é…ç½®

ç”±äº Rsbuild å†…ç½®äº†ä¸€äº›å¸¸è§çš„ loader å’Œ pluginï¼Œæ‰€ä»¥ä½ å¯ä»¥ç§»é™¤ä»¥ä¸‹ä¾èµ–å’Œç›¸å…³çš„é…ç½®ï¼Œè¿™ä¼šæ˜¾è‘—æå‡é¡¹ç›®çš„ä¾èµ–å®‰è£…é€Ÿåº¦ã€‚

- css-loader
- babel-loader
- style-loader
- postcss-loader
- html-webpack-plugin
- mini-css-extract-plugin
- autoprefixer
- @babel/core
- @babel/preset-env
- @babel/preset-typescript
- @babel/runtime
- ...

:::tip
ä»¥ä¸Šä»…åˆ—å‡ºäº†ä¸€äº›å¯ä»¥è¢«ç§»é™¤çš„å¸¸è§ä¾èµ–ã€‚åœ¨ä¸€ä¸ªçœŸå®çš„ webpack é¡¹ç›®ä¸­ï¼Œå¯èƒ½è¿˜å­˜åœ¨å¾ˆå¤šå…¶ä»–ä¾èµ–ï¼Œè¯·é…Œæƒ…å¤„ç†ã€‚
:::

### ä½¿ç”¨æ’ä»¶

Rsbuild æä¾›äº†ä¸°å¯Œçš„æ’ä»¶ï¼Œå¯¹å¸¸è§çš„ä½¿ç”¨åœºæ™¯æä¾›å¼€ç®±å³ç”¨çš„æ”¯æŒï¼Œä½ å¯ä»¥å‚è€ƒ[æ’ä»¶åˆ—è¡¨](/plugins/list/index)æ–‡æ¡£æ¥äº†è§£è¿™äº›æ’ä»¶ã€‚

æˆ‘ä»¬ä»¥ React é¡¹ç›®ä¸ºä¾‹ï¼Œæ¥ä»‹ç»å¦‚ä½•æ¥å…¥ Rsbuild æ’ä»¶ã€‚é¦–å…ˆï¼Œä½ å¯ä»¥ç§»é™¤ä¸€äº› React ç›¸å…³çš„æ„å»ºä¾èµ–ï¼Œå®ƒä»¬å·²ç»è¢« `@rsbuild/plugin-react` æ’ä»¶å†…ç½®ï¼Œæ¯”å¦‚ï¼š

- `react-refresh`
- `@babel/preset-react`
- `@pmmmwh/react-refresh-webpack-plugin`

ç„¶åå‚è€ƒ [React æ’ä»¶](/plugins/list/plugin-react) æ–‡æ¡£ï¼Œæ³¨å†Œå¹¶ä½¿ç”¨å³å¯ï¼š

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';
import { pluginReact } from '@rsbuild/plugin-react'; // [!code highlight]

export default defineConfig({
  plugins: [pluginReact()], // [!code highlight]
});
```

å¤§éƒ¨åˆ†å¸¸è§çš„ webpack loaders å’Œ plugins éƒ½èƒ½åœ¨ Rsbuild ä¸­ç»§ç»­ä½¿ç”¨ï¼Œä½†æˆ‘ä»¬æ¨èä½ ä¼˜å…ˆä½¿ç”¨ Rsbuild æä¾›çš„æ’ä»¶ï¼Œè¿™èƒ½å¤Ÿè¿›ä¸€æ­¥ç®€åŒ–ä½ çš„é…ç½®ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„æ˜ å°„å…³ç³»ï¼š

| webpack                                                                                    | Rsbuild                                                                                                     |
| ------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| [@babel/preset-react](https://npmjs.com/package/@babel/preset-react)                       | [React æ’ä»¶](/plugins/list/plugin-react)                                                                    |
| [vue-loader](https://npmjs.com/package/vue-loader)                                         | [Vue æ’ä»¶](/plugins/list/plugin-vue) æˆ– [Vue 2 æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-vue2) |
| [svelte-loader](https://npmjs.com/package/svelte-loader)                                   | [Svelte æ’ä»¶](/plugins/list/plugin-svelte)                                                                  |
| [babel-preset-solid](https://npmjs.com/package/babel-preset-solid)                         | [Solid æ’ä»¶](/plugins/list/plugin-solid)                                                                    |
| [babel-loader](https://npmjs.com/package/babel-loader)                                     | [Babel æ’ä»¶](/plugins/list/plugin-babel)                                                                    |
| [sass-loader](https://npmjs.com/package/sass-loader)                                       | [Sass æ’ä»¶](/plugins/list/plugin-sass)                                                                      |
| [less-loader](https://npmjs.com/package/less-loader)                                       | [Less æ’ä»¶](/plugins/list/plugin-less)                                                                      |
| [stylus-loader](https://npmjs.com/package/stylus-loader)                                   | [Stylus æ’ä»¶](/plugins/list/plugin-stylus)                                                                  |
| [mdx-loader](https://npmjs.com/package/mdx-loader)                                         | [MDX æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-mdx)                                            |
| [pug-loader](https://npmjs.com/package/pug-loader)                                         | [Pug æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-pug)                                            |
| [yaml-loader](https://npmjs.com/package/yaml-loader)                                       | [Yaml æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-yaml)                                          |
| [toml-loader](https://npmjs.com/package/toml-loader)                                       | [TOML æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-toml)                                          |
| [@svgr/webpack](https://npmjs.com/package/@svgr/webpack)                                   | [SVGR æ’ä»¶](/plugins/list/plugin-svgr)                                                                      |
| [fork-ts-checker-webpack-plugin](https://npmjs.com/package/fork-ts-checker-webpack-plugin) | [@rsbuild/plugin-type-check](https://github.com/rspack-contrib/rsbuild-plugin-type-check)                   |
| [node-polyfill-webpack-plugin](https://npmjs.com/package/node-polyfill-webpack-plugin)     | [Node Polyfill æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-node-polyfill)                        |
| [@vue/babel-plugin-jsx](https://npmjs.com/package/@vue/babel-plugin-jsx)                   | [Vue JSX æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-vue-jsx)                                    |
| [@vue/babel-preset-jsx](https://npmjs.com/package/@vue/babel-preset-jsx)                   | [Vue 2 JSX æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-vue2-jsx)                                 |
| [eslint-webpack-plugin](https://npmjs.com/package/eslint-webpack-plugin)                   | [ESLint æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-eslint)                                      |
| [babel-plugin-styled-components](https://npmjs.com/package/babel-plugin-styled-components) | [Styled Components æ’ä»¶](https://github.com/rspack-contrib/rsbuild-plugin-styled-components)                |

### é…ç½® Dev server

Rsbuild ä¸æ”¯æŒä½¿ç”¨ Rspack çš„ [devServer](https://rspack.rs/zh/config/dev-server) é…ç½®é¡¹ï¼Œè¯·å‚è€ƒ [Rspack Dev Server](/guide/basic/server#rspack-dev-server) è¿›è¡Œæ›¿æ¢ã€‚

## Babel è¿ç§»

Rsbuild é»˜è®¤ä½¿ç”¨ SWC ç¼–è¯‘ä»£ç ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†å¸¸ç”¨çš„ Babel æ’ä»¶ä¸å†éœ€è¦ï¼Œä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ Babel æ’ä»¶çš„è¿ç§»ç¤ºä¾‹ã€‚

### @babel/preset-env

`@babel/preset-env` ä¸å†éœ€è¦ï¼ŒRsbuild ä¼šè‡ªåŠ¨æ ¹æ® [browserslist](/guide/advanced/browserslist) é…ç½®è¿›è¡Œä»£ç é™çº§ã€‚

æ³¨æ„ Rsbuild é»˜è®¤ä¸ä¼šæ³¨å…¥ polyfillï¼Œä½ å¯ä»¥å‚è€ƒ [Polyfill æ–¹æ¡ˆ](/guide/advanced/browser-compatibility#polyfill-æ–¹æ¡ˆ) äº†è§£å¦‚ä½•æ³¨å…¥ã€‚

### @babel/preset-typescript

`@babel/preset-typescript` ä¸å†éœ€è¦ï¼Œå› ä¸º Rsbuild å¼€å¯ SWC çš„ TypeScript è½¬æ¢ã€‚

### @babel/preset-react

`@babel/preset-react` ä¸å†éœ€è¦ï¼Œæ›¿æ¢ä¸º [@rsbuild/plugin-react](/plugins/list/plugin-react) å³å¯ã€‚

### @babel/plugin-transform-runtime

`@babel/plugin-transform-runtime` ä¸å†éœ€è¦ï¼ŒRsbuild ä¸­å†…ç½®äº†ç­‰ä»·çš„ `@swc/helpers` ä½œä¸º runtime helpersã€‚

### babel-plugin-import

`babel-plugin-import` æ’ä»¶å¯ä»¥æ›¿æ¢ä¸º Rsbuild çš„ [source.transformImport](/config/source/transform-import) é…ç½®é¡¹ã€‚

- Babel é…ç½®ï¼š

```js title="babel.config.js"
module.exports = {
  plugins: [
    [
      'import',
      { libraryName: 'some-library', libraryDirectory: 'es', style: true },
    ],
  ],
};
```

- Rsbuild é…ç½®ï¼š

```ts title="rsbuild.config.ts"
import { defineConfig } from '@rsbuild/core';

export default defineConfig({
  source: {
    transformImport: [
      { libraryName: 'some-library', libraryDirectory: 'es', style: true },
    ],
  },
});
```

## éªŒè¯ç»“æœ

å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ å·²ç»å®Œæˆäº†ä» webpack åˆ° Rsbuild çš„åŸºæœ¬è¿ç§»ï¼Œæ­¤æ—¶å¯ä»¥æ‰§è¡Œ `npm run dev` å‘½ä»¤æ¥å°è¯•å¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚

å¦‚æœåœ¨æ„å»ºè¿‡ç¨‹ä¸­å‘ç°é—®é¢˜ï¼Œè¯·æ ¹æ®é”™è¯¯æ—¥å¿—è¿›è¡Œè°ƒè¯•ï¼Œæˆ–è€…æŸ¥çœ‹ webpack é…ç½®ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ä¸€äº›å¿…é¡»çš„é…ç½®æœªè¢«è¿ç§»åˆ° Rsbuildã€‚

## å†…å®¹è¡¥å……

å½“å‰æ–‡æ¡£åªæ¶µç›–äº†è¿ç§»è¿‡ç¨‹çš„éƒ¨åˆ†äº‹é¡¹ï¼Œå¦‚æœä½ å‘ç°æœ‰åˆé€‚çš„å†…å®¹å¯ä»¥è¡¥å……ï¼Œæ¬¢è¿é€šè¿‡ pull request æ¥å®Œå–„æ–‡æ¡£ ğŸ¤ã€‚

> Rsbuild çš„æ–‡æ¡£ä½äº [rsbuild/website](https://github.com/web-infra-dev/rsbuild/tree/main/website) ç›®å½•ã€‚
