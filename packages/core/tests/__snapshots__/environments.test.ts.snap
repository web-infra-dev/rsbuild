// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`environment config > should normalize environment config correctly 1`] = `
{
  "dev": {
    "assetPrefix": "/",
    "client": {
      "host": "",
      "overlay": true,
      "path": "/rsbuild-hmr",
      "port": "",
    },
    "hmr": true,
    "lazyCompilation": true,
    "liveReload": true,
    "writeToDisk": false,
  },
  "html": {
    "crossorigin": false,
    "inject": "head",
    "meta": {
      "charset": {
        "charset": "UTF-8",
      },
      "viewport": "width=device-width, initial-scale=1.0",
    },
    "mountId": "root",
    "outputStructure": "flat",
    "scriptLoading": "defer",
    "title": "Rsbuild App",
  },
  "output": {
    "assetPrefix": "/",
    "charset": "ascii",
    "cssModules": {
      "auto": true,
      "exportGlobals": false,
      "exportLocalsConvention": "camelCase",
      "namedExport": false,
    },
    "dataUriLimit": {
      "font": 4096,
      "image": 4096,
      "media": 4096,
      "svg": 4096,
    },
    "distPath": {
      "css": "static/css",
      "font": "static/font",
      "html": "/",
      "image": "static/image",
      "js": "static/js",
      "media": "static/media",
      "root": "dist",
      "svg": "static/svg",
      "wasm": "static/wasm",
    },
    "emitAssets": true,
    "filename": {},
    "filenameHash": true,
    "injectStyles": false,
    "inlineScripts": false,
    "inlineStyles": false,
    "legalComments": "linked",
    "manifest": false,
    "minify": true,
    "polyfill": "off",
    "sourceMap": {
      "css": false,
      "js": undefined,
    },
    "target": "web",
  },
  "performance": {
    "buildCache": true,
    "chunkSplit": {
      "strategy": "split-by-experience",
    },
    "printFileSize": true,
    "profile": false,
    "removeConsole": false,
    "removeMomentLocale": false,
  },
  "security": {
    "nonce": "",
    "sri": {
      "enable": false,
    },
  },
  "server": {
    "compress": true,
    "host": "0.0.0.0",
    "htmlFallback": "index",
    "open": false,
    "port": 3000,
    "printUrls": true,
    "strictPort": false,
  },
  "source": {
    "alias": {
      "@common": "src/common",
    },
    "aliasStrategy": "prefer-tsconfig",
    "decorators": {
      "version": "2022-03",
    },
    "define": {},
    "entry": {
      "index": "src/index.client.js",
    },
    "preEntry": [],
  },
  "tools": {
    "cssExtract": {
      "loaderOptions": {},
      "pluginOptions": {
        "ignoreOrder": true,
      },
    },
  },
}
`;

exports[`environment config > should normalize environment config correctly 2`] = `
{
  "dev": {
    "assetPrefix": "/foo",
    "client": {
      "host": "",
      "overlay": true,
      "path": "/rsbuild-hmr",
      "port": "",
    },
    "hmr": true,
    "lazyCompilation": false,
    "liveReload": true,
    "writeToDisk": false,
  },
  "html": {
    "crossorigin": false,
    "inject": "head",
    "meta": {
      "charset": {
        "charset": "UTF-8",
      },
      "viewport": "width=device-width, initial-scale=1.0",
    },
    "mountId": "root",
    "outputStructure": "flat",
    "scriptLoading": "defer",
    "title": "Rsbuild App",
  },
  "output": {
    "assetPrefix": "/",
    "charset": "ascii",
    "cssModules": {
      "auto": true,
      "exportGlobals": false,
      "exportLocalsConvention": "camelCase",
      "namedExport": false,
    },
    "dataUriLimit": {
      "font": 4096,
      "image": 4096,
      "media": 4096,
      "svg": 4096,
    },
    "distPath": {
      "css": "static/css",
      "font": "static/font",
      "html": "/",
      "image": "static/image",
      "js": "",
      "media": "static/media",
      "root": "dist",
      "svg": "static/svg",
      "wasm": "static/wasm",
    },
    "emitAssets": true,
    "filename": {},
    "filenameHash": true,
    "injectStyles": false,
    "inlineScripts": false,
    "inlineStyles": false,
    "legalComments": "linked",
    "manifest": false,
    "minify": true,
    "polyfill": "off",
    "sourceMap": {
      "css": false,
      "js": undefined,
    },
    "target": "node",
  },
  "performance": {
    "buildCache": true,
    "chunkSplit": {
      "strategy": "split-by-experience",
    },
    "printFileSize": true,
    "profile": false,
    "removeConsole": false,
    "removeMomentLocale": false,
  },
  "security": {
    "nonce": "",
    "sri": {
      "enable": false,
    },
  },
  "server": {
    "compress": true,
    "host": "0.0.0.0",
    "htmlFallback": "index",
    "open": false,
    "port": 3000,
    "printUrls": true,
    "strictPort": false,
  },
  "source": {
    "alias": {
      "@common": "src/common",
    },
    "aliasStrategy": "prefer-tsconfig",
    "decorators": {
      "version": "2022-03",
    },
    "define": {},
    "entry": {
      "index": "src/index.server.js",
    },
    "preEntry": [],
  },
  "tools": {
    "cssExtract": {
      "loaderOptions": {},
      "pluginOptions": {
        "ignoreOrder": true,
      },
    },
  },
}
`;

exports[`environment config > should print environment config when inspect config 1`] = `
{
  "ssr": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {
        "index": "src/index.server.js",
      },
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
  "web": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {
        "index": "src/index.client.js",
      },
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
}
`;

exports[`environment config > should support add single environment plugin 1`] = `
{
  "ssr": {
    "global": "ssr",
    "ssr": "ssr",
  },
  "web": {
    "global": "web",
    "web": "web",
  },
}
`;

exports[`environment config > should support modify environment config by api.modifyRsbuildConfig 1`] = `
{
  "ssr": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
      "test-environment",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {
        "index": "src/index.server.js",
      },
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
  "web": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
      "test-environment",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
        "@common1": "src/common1",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {
        "index": "src/index.client.js",
      },
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
  "web1": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
      "test-environment",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
        "@common1": "src/common1",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {},
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
}
`;

exports[`environment config > should support modify single environment config by api.modifyEnvironmentConfig 1`] = `
{
  "ssr": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
      "test-environment",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {
        "index": "src/index.server.js",
      },
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
  "web": {
    "dev": {
      "assetPrefix": "/",
      "client": {
        "host": "",
        "overlay": true,
        "path": "/rsbuild-hmr",
        "port": "",
      },
      "hmr": true,
      "lazyCompilation": undefined,
      "liveReload": true,
      "writeToDisk": false,
    },
    "html": {
      "crossorigin": false,
      "inject": "head",
      "meta": {
        "charset": {
          "charset": "UTF-8",
        },
        "viewport": "width=device-width, initial-scale=1.0",
      },
      "mountId": "root",
      "outputStructure": "flat",
      "scriptLoading": "defer",
      "title": "Rsbuild App",
    },
    "output": {
      "assetPrefix": "/",
      "charset": "ascii",
      "cssModules": {
        "auto": true,
        "exportGlobals": false,
        "exportLocalsConvention": "camelCase",
        "namedExport": false,
      },
      "dataUriLimit": {
        "font": 4096,
        "image": 4096,
        "media": 4096,
        "svg": 4096,
      },
      "distPath": {
        "css": "static/css",
        "font": "static/font",
        "html": "/",
        "image": "static/image",
        "js": "static/js",
        "media": "static/media",
        "root": "dist",
        "svg": "static/svg",
        "wasm": "static/wasm",
      },
      "emitAssets": true,
      "filename": {},
      "filenameHash": true,
      "injectStyles": false,
      "inlineScripts": false,
      "inlineStyles": false,
      "legalComments": "linked",
      "manifest": false,
      "minify": true,
      "polyfill": "off",
      "sourceMap": {
        "css": false,
        "js": undefined,
      },
      "target": "web",
    },
    "performance": {
      "buildCache": true,
      "chunkSplit": {
        "strategy": "split-by-experience",
      },
      "printFileSize": true,
      "profile": false,
      "removeConsole": false,
      "removeMomentLocale": false,
    },
    "pluginNames": [
      "rsbuild:basic",
      "rsbuild:entry",
      "rsbuild:cache",
      "rsbuild:target",
      "rsbuild:output",
      "rsbuild:resolve",
      "rsbuild:file-size",
      "rsbuild:clean-output",
      "rsbuild:asset",
      "rsbuild:html",
      "rsbuild:app-icon",
      "rsbuild:wasm",
      "rsbuild:moment",
      "rsbuild:node-addons",
      "rsbuild:define",
      "rsbuild:css",
      "rsbuild:minimize",
      "rsbuild:progress",
      "rsbuild:swc",
      "rsbuild:externals",
      "rsbuild:split-chunks",
      "rsbuild:open",
      "rsbuild:inline-chunk",
      "rsbuild:rsdoctor",
      "rsbuild:resource-hints",
      "rsbuild:performance",
      "rsbuild:bundle-analyzer",
      "rsbuild:server",
      "rsbuild:manifest",
      "rsbuild:module-federation",
      "rsbuild:rspack-profile",
      "rsbuild:lazy-compilation",
      "rsbuild:sri",
      "rsbuild:nonce",
      "test-environment",
    ],
    "security": {
      "nonce": "",
      "sri": {
        "enable": false,
      },
    },
    "server": {
      "compress": true,
      "host": "0.0.0.0",
      "htmlFallback": "index",
      "open": false,
      "port": 3000,
      "printUrls": true,
      "strictPort": false,
    },
    "source": {
      "alias": {
        "@common": "src/common",
        "@common1": "src/common1",
      },
      "aliasStrategy": "prefer-tsconfig",
      "decorators": {
        "version": "2022-03",
      },
      "define": {},
      "entry": {
        "index": "src/index.client.js",
      },
      "preEntry": [],
    },
    "tools": {
      "cssExtract": {
        "loaderOptions": {},
        "pluginOptions": {
          "ignoreOrder": true,
        },
      },
    },
  },
}
`;

exports[`environment config > tools.rspack / bundlerChain can be used in environment config 1`] = `
[
  {
    "context": "<ROOT>",
    "devtool": "eval-source-map",
    "experiments": {
      "asyncWebAssembly": true,
    },
    "infrastructureLogging": {
      "level": "error",
    },
    "mode": "development",
    "module": {
      "parser": {
        "javascript": {
          "exportsPresence": "error",
        },
      },
      "rules": [
        {
          "resolve": {
            "fullySpecified": false,
          },
          "test": /\\\\\\.m\\?js/,
        },
        {
          "resolve": {
            "preferRelative": true,
          },
          "sideEffects": true,
          "test": /\\\\\\.css\\$/,
          "type": "javascript/auto",
          "use": [
            {
              "loader": "<ROOT>/node_modules/<PNPM_INNER>/@rspack/core/dist/builtin-plugin/css-extract/loader.js",
            },
            {
              "loader": "<ROOT>/packages/core/compiled/css-loader",
              "options": {
                "importLoaders": 1,
                "modules": {
                  "auto": true,
                  "exportGlobals": false,
                  "exportLocalsConvention": "camelCase",
                  "localIdentName": "[path][name]__[local]-[hash:base64:6]",
                  "namedExport": false,
                },
                "sourceMap": false,
              },
            },
            {
              "loader": "builtin:lightningcss-loader",
              "options": {
                "targets": {
                  "chrome": 5701632,
                  "edge": 5767168,
                  "firefox": 5111808,
                  "safari": 917504,
                },
              },
            },
          ],
        },
        {
          "include": [
            {
              "and": [
                "<ROOT>",
                {
                  "not": /\\[\\\\\\\\/\\]node_modules\\[\\\\\\\\/\\]/,
                },
              ],
            },
            /\\\\\\.\\(\\?:ts\\|tsx\\|jsx\\|mts\\|cts\\)\\$/,
          ],
          "test": /\\\\\\.\\(\\?:js\\|jsx\\|mjs\\|cjs\\|ts\\|tsx\\|mts\\|cts\\)\\$/,
          "type": "javascript/auto",
          "use": [
            {
              "loader": "builtin:swc-loader",
              "options": {
                "env": {
                  "mode": undefined,
                  "targets": [
                    "chrome >= 87",
                    "edge >= 88",
                    "firefox >= 78",
                    "safari >= 14",
                  ],
                },
                "isModule": "unknown",
                "jsc": {
                  "experimental": {
                    "cacheRoot": "<ROOT>/node_modules/.cache/.swc",
                  },
                  "externalHelpers": true,
                  "parser": {
                    "decorators": true,
                    "syntax": "typescript",
                    "tsx": false,
                  },
                  "preserveAllComments": true,
                  "transform": {
                    "decoratorVersion": "2022-03",
                    "legacyDecorator": false,
                  },
                },
              },
            },
          ],
        },
        {
          "mimetype": {
            "or": [
              "text/javascript",
              "application/javascript",
            ],
          },
          "resolve": {
            "fullySpecified": false,
          },
          "use": [
            {
              "loader": "builtin:swc-loader",
              "options": {
                "env": {
                  "mode": undefined,
                  "targets": [
                    "chrome >= 87",
                    "edge >= 88",
                    "firefox >= 78",
                    "safari >= 14",
                  ],
                },
                "isModule": "unknown",
                "jsc": {
                  "experimental": {
                    "cacheRoot": "<ROOT>/node_modules/.cache/.swc",
                  },
                  "externalHelpers": true,
                  "parser": {
                    "decorators": true,
                    "syntax": "typescript",
                    "tsx": false,
                  },
                  "preserveAllComments": true,
                  "transform": {
                    "decoratorVersion": "2022-03",
                    "legacyDecorator": false,
                  },
                },
              },
            },
          ],
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/image/[name].[contenthash:8][ext]",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/image/[name].[contenthash:8][ext]",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.\\(\\?:png\\|jpg\\|jpeg\\|pjpeg\\|pjp\\|gif\\|bmp\\|webp\\|ico\\|apng\\|avif\\|tif\\|tiff\\|jfif\\)\\$/i,
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/svg/[name].[contenthash:8].svg",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/svg/[name].[contenthash:8].svg",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.svg\\$/i,
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/media/[name].[contenthash:8][ext]",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/media/[name].[contenthash:8][ext]",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.\\(\\?:mp4\\|webm\\|ogg\\|mov\\|mp3\\|wav\\|flac\\|aac\\|m4a\\|opus\\)\\$/i,
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/font/[name].[contenthash:8][ext]",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/font/[name].[contenthash:8][ext]",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.\\(\\?:woff\\|woff2\\|eot\\|ttf\\|otf\\|ttc\\)\\$/i,
        },
        {
          "dependency": "url",
          "generator": {
            "filename": "static/wasm/[hash].module.wasm",
          },
          "test": /\\\\\\.wasm\\$/,
          "type": "asset/resource",
        },
      ],
    },
    "name": "web",
    "optimization": {
      "minimize": false,
      "splitChunks": {
        "cacheGroups": {
          "lib-axios": {
            "name": "lib-axios",
            "priority": 0,
            "test": /node_modules\\[\\\\\\\\/\\]axios\\(-\\.\\+\\)\\?\\[\\\\\\\\/\\]/,
          },
          "lib-lodash": {
            "name": "lib-lodash",
            "priority": 0,
            "test": /node_modules\\[\\\\\\\\/\\]lodash\\(-es\\)\\?\\[\\\\\\\\/\\]/,
          },
        },
        "chunks": "all",
        "enforceSizeThreshold": 50000,
      },
    },
    "output": {
      "chunkFilename": "static/js/async/[name].js",
      "devtoolModuleFilenameTemplate": [Function],
      "filename": "static/js/[name].js",
      "hashFunction": "xxhash64",
      "path": "<ROOT>/dist",
      "pathinfo": false,
      "publicPath": "/",
      "webassemblyModuleFilename": "static/wasm/[hash].module.wasm",
    },
    "performance": {
      "hints": false,
    },
    "plugins": [
      RsbuildCorePlugin {},
      HotModuleReplacementPlugin {
        "name": "HotModuleReplacementPlugin",
      },
      CssExtractRspackPlugin {
        "options": {
          "chunkFilename": "static/css/async/[name].css",
          "filename": "static/css/[name].css",
          "ignoreOrder": true,
        },
      },
      DefinePlugin {
        "_args": [
          {
            "process.env.ASSET_PREFIX": """",
            "process.env.NODE_ENV": ""development"",
          },
        ],
        "affectedHooks": "compilation",
        "name": "DefinePlugin",
      },
    ],
    "resolve": {
      "alias": {
        "@swc/helpers": "<ROOT>/node_modules/<PNPM_INNER>/@swc/helpers",
      },
      "extensions": [
        ".ts",
        ".tsx",
        ".js",
        ".jsx",
        ".mjs",
        ".json",
      ],
    },
    "target": [
      "web",
      "es2017",
    ],
  },
  {
    "context": "<ROOT>",
    "devtool": "eval",
    "experiments": {
      "asyncWebAssembly": true,
    },
    "infrastructureLogging": {
      "level": "error",
    },
    "mode": "development",
    "module": {
      "parser": {
        "javascript": {
          "exportsPresence": "error",
        },
      },
      "rules": [
        {
          "resolve": {
            "fullySpecified": false,
          },
          "test": /\\\\\\.m\\?js/,
        },
        {
          "resolve": {
            "preferRelative": true,
          },
          "sideEffects": true,
          "test": /\\\\\\.css\\$/,
          "type": "javascript/auto",
          "use": [
            {
              "loader": "<ROOT>/packages/core/src/ignoreCssLoader.cjs",
            },
            {
              "loader": "<ROOT>/packages/core/compiled/css-loader",
              "options": {
                "importLoaders": 0,
                "modules": {
                  "auto": true,
                  "exportGlobals": false,
                  "exportLocalsConvention": "camelCase",
                  "exportOnlyLocals": true,
                  "localIdentName": "[path][name]__[local]-[hash:base64:6]",
                  "namedExport": false,
                },
                "sourceMap": false,
              },
            },
          ],
        },
        {
          "include": [
            {
              "and": [
                "<ROOT>",
                {
                  "not": /\\[\\\\\\\\/\\]node_modules\\[\\\\\\\\/\\]/,
                },
              ],
            },
            /\\\\\\.\\(\\?:ts\\|tsx\\|jsx\\|mts\\|cts\\)\\$/,
          ],
          "test": /\\\\\\.\\(\\?:js\\|jsx\\|mjs\\|cjs\\|ts\\|tsx\\|mts\\|cts\\)\\$/,
          "type": "javascript/auto",
          "use": [
            {
              "loader": "builtin:swc-loader",
              "options": {
                "env": {
                  "targets": [
                    "node >= 16",
                  ],
                },
                "isModule": "unknown",
                "jsc": {
                  "experimental": {
                    "cacheRoot": "<ROOT>/node_modules/.cache/.swc",
                  },
                  "externalHelpers": true,
                  "parser": {
                    "decorators": true,
                    "syntax": "typescript",
                    "tsx": false,
                  },
                  "preserveAllComments": true,
                  "transform": {
                    "decoratorVersion": "2022-03",
                    "legacyDecorator": false,
                  },
                },
              },
            },
          ],
        },
        {
          "mimetype": {
            "or": [
              "text/javascript",
              "application/javascript",
            ],
          },
          "resolve": {
            "fullySpecified": false,
          },
          "use": [
            {
              "loader": "builtin:swc-loader",
              "options": {
                "env": {
                  "targets": [
                    "node >= 16",
                  ],
                },
                "isModule": "unknown",
                "jsc": {
                  "experimental": {
                    "cacheRoot": "<ROOT>/node_modules/.cache/.swc",
                  },
                  "externalHelpers": true,
                  "parser": {
                    "decorators": true,
                    "syntax": "typescript",
                    "tsx": false,
                  },
                  "preserveAllComments": true,
                  "transform": {
                    "decoratorVersion": "2022-03",
                    "legacyDecorator": false,
                  },
                },
              },
            },
          ],
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/image/[name].[contenthash:8][ext]",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/image/[name].[contenthash:8][ext]",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.\\(\\?:png\\|jpg\\|jpeg\\|pjpeg\\|pjp\\|gif\\|bmp\\|webp\\|ico\\|apng\\|avif\\|tif\\|tiff\\|jfif\\)\\$/i,
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/svg/[name].[contenthash:8].svg",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/svg/[name].[contenthash:8].svg",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.svg\\$/i,
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/media/[name].[contenthash:8][ext]",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/media/[name].[contenthash:8][ext]",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.\\(\\?:mp4\\|webm\\|ogg\\|mov\\|mp3\\|wav\\|flac\\|aac\\|m4a\\|opus\\)\\$/i,
        },
        {
          "oneOf": [
            {
              "generator": {
                "filename": "static/font/[name].[contenthash:8][ext]",
              },
              "resourceQuery": /\\(__inline=false\\|url\\)/,
              "type": "asset/resource",
            },
            {
              "resourceQuery": /inline/,
              "type": "asset/inline",
            },
            {
              "generator": {
                "filename": "static/font/[name].[contenthash:8][ext]",
              },
              "parser": {
                "dataUrlCondition": {
                  "maxSize": 4096,
                },
              },
              "type": "asset",
            },
          ],
          "test": /\\\\\\.\\(\\?:woff\\|woff2\\|eot\\|ttf\\|otf\\|ttc\\)\\$/i,
        },
        {
          "dependency": "url",
          "generator": {
            "filename": "static/wasm/[hash].module.wasm",
          },
          "test": /\\\\\\.wasm\\$/,
          "type": "asset/resource",
        },
        {
          "test": /\\\\\\.node\\$/,
          "use": [
            {
              "loader": "<ROOT>/packages/core/src/transformRawLoader.cjs",
              "options": {
                "getEnvironment": [Function],
                "id": "rsbuild-transform-0",
              },
            },
          ],
        },
      ],
    },
    "name": "node",
    "optimization": {
      "minimize": false,
      "splitChunks": false,
    },
    "output": {
      "chunkFilename": "[name].js",
      "devtoolModuleFilenameTemplate": [Function],
      "filename": "bundle.js",
      "hashFunction": "xxhash64",
      "library": {
        "type": "commonjs2",
      },
      "path": "<ROOT>/dist",
      "pathinfo": false,
      "publicPath": "/",
      "webassemblyModuleFilename": "static/wasm/[hash].module.wasm",
    },
    "performance": {
      "hints": false,
    },
    "plugins": [
      RsbuildCorePlugin {},
      DefinePlugin {
        "_args": [
          {
            "process.env.ASSET_PREFIX": """",
            "process.env.NODE_ENV": ""development"",
          },
        ],
        "affectedHooks": "compilation",
        "name": "DefinePlugin",
      },
    ],
    "resolve": {
      "alias": {
        "@swc/helpers": "<ROOT>/node_modules/<PNPM_INNER>/@swc/helpers",
      },
      "extensions": [
        ".ts",
        ".tsx",
        ".js",
        ".jsx",
        ".mjs",
        ".json",
      ],
    },
    "target": "node",
  },
]
`;
